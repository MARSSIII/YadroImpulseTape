# TapeSorter

TapeSorter — консольное приложение на C++, предназначенное для сортировки целочисленных данных, хранящихся в бинарных файлах. Приложение моделирует механику работы ленточного накопителя, учитывая ограничения последовательного доступа и настраиваемые аппаратные задержки.

## Описание

Проект реализует алгоритм сортировки, рассчитанный на работу при строгих ограничениях памяти. Файлы рассматриваются как «ленты», данные на которых могут быть прочитаны или записаны только последовательно через считывающую/записывающую головку. Процесс сортировки включает разделение данных на временные блоки, их сортировку в памяти в рамках заданного лимита и последующее слияние в отсортированную выходную ленту.

Ключевые особенности:
- **Моделирование интерфейса ленты**: Строгое соблюдение последовательного чтения, записи и перемещения головки (сдвиг/перемотка).
- **Настраиваемые задержки**: Моделирование временных задержек для операций ввода-вывода, имитирующих аппаратные ограничения.
- **Управление памятью**: Настраиваемое ограничение оперативной памяти для буфера сортировки.
- **Поддержка бинарных файлов**: Оптимизировано для обработки 32-битных знаковых целых чисел в бинарном формате.

## Требования

- **Стандарт C++**: C++20 или новее.
- **CMake**: Версия 3.25 или новее.
- **Компилятор**: GCC, Clang или MSVC с поддержкой C++20.

## Инструкция по сборке

Чтобы собрать проект, выполните следующие шаги:

1. Создайте директорию для сборки:
   ```bash
   mkdir build
   cd build
   ```

2. Настройте проект с помощью CMake:
   ```bash
   cmake ..
   ```

3. Соберите приложение:
   ```bash
   cmake --build .
   ```

После успешной компиляции исполняемый файл `TapeSorter` и `TapeSorterTests` (если тестирование включено) будут доступны в директории сборки.

## Использование

Приложению необходимы пути к входному и выходному файлам. Дополнительно можно указать файл конфигурации для настройки параметров моделирования.

### Синтаксис командной строки

```bash
./TapeSorter <input_file> <output_file> [config_file]
```

- **input_file**: Путь к исходному бинарному файлу.
- **output_file**: Путь к целевому бинарному файлу (будет перезаписан).
- **config_file**: (Опционально) Путь к файлу конфигурации.

### Пример

```bash
./TapeSorter input.bin output.bin config.cfg
```

## Конфигурация

Файл конфигурации использует формат «ключ-значение». Строки, начинающиеся с `#`, игнорируются. Если файл не предоставлен, задержки по умолчанию равны 0 мс, а лимит памяти — 1024 байта.

### Параметры

- `read_delay`: Задержка в миллисекундах для чтения одного целого числа.
- `write_delay`: Задержка в миллисекундах для записи одного целого числа.
- `rewind_delay`: Задержка в миллисекундах для перемотки ленты.
- `shift_delay`: Задержка в миллисекундах для перемещения головки ленты на одну позицию.
- `memory_limit`: Максимальное использование памяти в байтах для буфера сортировки.

### Пример конфигурационного файла

```ini
# Задержки в миллисекундах
read_delay = 1
write_delay = 1
rewind_delay = 5
shift_delay = 1

# Лимит памяти в байтах
memory_limit = 1048576
```

## Тестирование

Проект использует GoogleTest для модульного тестирования. Тесты охватывают логику моделирования ленты, разбора конфигурации и алгоритмов сортировки.

Чтобы запустить тесты:

```bash
./TapeSorterTests
```

Или с помощью CTest:

```bash
ctest --output-on-failure
```

## Структура проекта

- **include/**: Заголовочные файлы, определяющие интерфейсы и сущности.
  - **interfaces/**: `TapeInterface`, `TapeConfigFactoryInterface`.
  - **entities/**: `BinaryFileTape`, `TapeSorter`, `TapeConfig`.
  - **factories/**: `TapeConfigFactory`.
- **src/**: Исходный код реализации.
- **tests/**: Модульные тесты.

## Лицензия

Этот проект создан в образовательных и демонстрационных целях.
